# 工厂测试系统操作手册

**版本**: 1.0.0  
**发布日期**: 2025年1月  
**适用系统**: Factory Testing System  

---

## 目录

### 第一章 系统概述
- [1.1 系统简介](#11-系统简介)
- [1.2 系统架构](#12-系统架构)
- [1.3 系统特点](#13-系统特点)
- [1.4 适用范围](#14-适用范围)

### 第二章 安装与配置
- [2.1 系统要求](#21-系统要求)
- [2.2 软件安装](#22-软件安装)
- [2.3 首次启动配置](#23-首次启动配置)
- [2.4 PLC连接配置](#24-plc连接配置)

### 第三章 界面介绍
- [3.1 主界面布局](#31-主界面布局)
- [3.2 导航菜单](#32-导航菜单)
- [3.3 状态栏说明](#33-状态栏说明)
- [3.4 快速导航](#34-快速导航)

### 第四章 基础操作
- [4.1 数据导入管理](#41-数据导入管理)
- [4.2 测试PLC配置](#42-测试plc配置)
- [4.3 测试批次管理](#43-测试批次管理)
- [4.4 测试执行操作](#44-测试执行操作)

### 第五章 高级功能
- [5.1 手动测试功能](#51-手动测试功能)
- [5.2 上位机功能检查](#52-上位机功能检查)
- [5.3 测试结果分析](#53-测试结果分析)
- [5.4 报告生成与导出](#54-报告生成与导出)

### 第六章 故障排除
- [6.1 常见问题](#61-常见问题)
- [6.2 错误代码说明](#62-错误代码说明)
- [6.3 系统日志查看](#63-系统日志查看)
- [6.4 技术支持](#64-技术支持)

### 第七章 附录
- [7.1 Excel模板格式](#71-excel模板格式)
- [7.2 PLC地址映射表](#72-plc地址映射表)
- [7.3 系统配置文件](#73-系统配置文件)
- [7.4 数据库备份恢复](#74-数据库备份恢复)

---

## 第一章 系统概述

### 1.1 系统简介

工厂测试系统（Factory Testing System）是一款专业的PLC设备自动化测试软件，主要用于工厂验收测试（FAT - Factory Acceptance Test）环节。系统采用现代化的桌面应用架构，集成了数据导入、测试执行、结果分析、报告生成等完整的测试流程功能。

**【插入图片位置1】**: 系统启动主界面截图

#### 主要功能模块：

1. **数据导入模块**: 支持从Excel文件导入测试点位配置信息
2. **测试PLC配置**: 管理测试PLC设备的连接参数和通道映射
3. **测试执行引擎**: 自动化执行AI/AO/DI/DO四种类型通道的测试
4. **手动测试工具**: 提供手动控制和调试功能
5. **结果管理系统**: 测试结果的存储、查看和分析
6. **报告生成器**: 自动生成测试报告和数据导出

### 1.2 系统架构

系统采用C/S架构设计，基于Tauri框架构建：

- **前端界面**: Angular框架，提供现代化用户界面
- **后端服务**: Rust语言开发，保证高性能和稳定性
- **数据存储**: SQLite数据库，轻量级本地存储
- **通信协议**: 支持Modbus TCP、西门子S7、OPC UA等主流PLC协议

**【插入图片位置2】**: 系统架构图

### 1.3 系统特点

#### 技术特点：
- ✅ 跨平台支持（Windows/Linux/macOS）
- ✅ 模块化设计，易于扩展
- ✅ 实时状态监控
- ✅ 异步处理架构，响应迅速
- ✅ 数据库事务保护，确保数据一致性

#### 功能特点：
- 🔧 支持多种PLC协议和厂商设备
- 📊 完整的测试流程管理
- 📈 实时测试进度和状态显示
- 📋 灵活的测试配置和自定义
- 📄 标准化测试报告生成
- 🔍 详细的错误诊断和日志记录

### 1.4 适用范围

本系统适用于以下场景：

1. **工厂验收测试（FAT）**: 设备出厂前的功能验证
2. **系统集成测试**: PLC控制系统的集成验证
3. **设备调试**: 现场设备的调试和故障诊断
4. **质量控制**: 批量产品的质量检验
5. **技术服务**: 售后服务和技术支持

**适用行业**：
- 石油化工
- 电力能源
- 制药食品
- 水处理
- 制造业
- 楼宇自控

---

## 第二章 安装与配置

### 2.1 系统要求

#### 硬件要求：
- **处理器**: Intel i3 或 AMD 同等级别以上
- **内存**: 4GB RAM 最低，推荐 8GB 以上
- **硬盘**: 500MB 可用空间（不含测试数据）
- **网络**: 以太网接口（用于PLC通信）

#### 软件要求：
- **操作系统**: Windows 10/11 (64位)
- **.NET**: 系统自带，无需额外安装
- **网络协议**: TCP/IP 支持

#### 网络要求：
- 与测试PLC在同一网段或网络可达
- 防火墙需开放Modbus端口（默认502）
- 建议使用有线网络连接

### 2.2 软件安装

#### 安装步骤：

1. **获取安装包**
   - 从官方渠道下载安装包
   - 验证文件完整性（MD5校验）

**【插入图片位置3】**: 安装包下载界面

2. **运行安装程序**
   ```
   双击 factory-testing-setup.exe
   ```

3. **安装向导**
   - 选择安装语言（中文）
   - 阅读并同意许可协议
   - 选择安装路径（默认：C:\Program Files\FactoryTesting）
   - 选择开始菜单文件夹
   - 确认安装设置

**【插入图片位置4】**: 安装向导界面

4. **完成安装**
   - 等待文件复制完成
   - 选择是否立即启动系统
   - 点击"完成"

#### 卸载方法：
- 通过控制面板"程序和功能"卸载
- 或运行安装目录下的uninstall.exe

### 2.3 首次启动配置

#### 启动系统：
1. 双击桌面快捷方式"工厂测试系统"
2. 或从开始菜单启动

**【插入图片位置5】**: 首次启动加载界面

#### 初始配置：

1. **基本设置**
   - 系统会自动创建配置文件
   - 数据库文件初始化
   - 检查必要的目录结构

2. **操作员信息**
   - 设置默认操作员姓名
   - 配置工作环境参数

**【插入图片位置6】**: 基本设置界面

3. **主题设置**
   - 选择界面主题（浅色/深色）
   - 配置显示语言

### 2.4 PLC连接配置

#### 配置测试PLC：

1. **进入PLC配置界面**
   - 点击顶部菜单"测试PLC配置"
   - 进入PLC连接管理界面

**【插入图片位置7】**: PLC配置主界面

2. **添加PLC设备**
   - 点击"添加PLC"按钮
   - 填写PLC基本信息：
     - 设备名称：测试PLC_01
     - PLC类型：Modbus TCP
     - IP地址：192.168.1.100
     - 端口：502
     - 超时时间：5000ms
     - 重试次数：3

**【插入图片位置8】**: 添加PLC设备对话框

3. **高级配置**
   - 字节序设置：ABCD（大端）
   - 地址偏移：启用零基址
   - 连接测试：点击"测试连接"验证

4. **保存配置**
   - 点击"保存"确认配置
   - 系统自动验证连接状态

#### 配置被测PLC：

1. **添加被测设备**
   - 设备名称：生产PLC_01
   - IP地址：192.168.1.200
   - 标记为"被测PLC"

2. **通道映射配置**
   - 配置AI/AO/DI/DO通道地址映射
   - 设置量程寄存器地址

**【插入图片位置9】**: 通道映射配置界面

---

## 第三章 界面介绍

### 3.1 主界面布局

系统主界面采用经典的工业软件布局设计：

**【插入图片位置10】**: 主界面完整截图，标注各区域

#### 界面组成：

1. **顶部标题栏**
   - 系统名称：工厂验收测试系统
   - 版本信息：v1.0.0
   - 最小化/最大化/关闭按钮

2. **导航菜单栏**
   - 水平导航菜单
   - 图标+文字设计
   - 当前页面高亮显示

3. **状态监控区**
   - 系统状态指示器
   - PLC连接状态
   - 最后检查时间

4. **主内容区**
   - 动态内容显示
   - 各功能模块界面
   - 响应式布局

### 3.2 导航菜单

#### 主要菜单项：

**【插入图片位置11】**: 导航菜单栏特写

1. **🏠 仪表盘**
   - 系统概览和快速导航
   - 最近批次列表
   - 系统状态监控

2. **⚙️ 测试PLC配置**
   - PLC设备管理
   - 连接参数配置
   - 通道地址映射

3. **💾 数据导入**
   - Excel文件导入
   - 点位配置管理
   - 批次创建向导

4. **🧪 测试区域**
   - 测试批次管理
   - 测试执行控制
   - 实时状态监控

5. **✅ 上位机功能检查**
   - 全局功能测试
   - 系统完整性检查
   - 功能模块验证

6. **📊 结果导出**
   - 测试报告生成
   - 数据导出功能
   - 历史数据查询

### 3.3 状态栏说明

#### 状态指示器：

**【插入图片位置12】**: 状态栏详细展示

1. **系统状态**
   - 🟢 正常：系统运行良好
   - 🔴 异常：存在错误或警告

2. **测试PLC状态**
   - 🟢 已连接：通信正常
   - 🔴 未连接：连接失败或未配置
   - 💡 闪烁：连接异常

3. **被测PLC状态**
   - 状态显示同测试PLC
   - 鼠标悬停显示设备名称

4. **最后检查时间**
   - 显示最近一次状态检查的时间
   - 格式：HH:mm:ss

### 3.4 快速导航

仪表盘提供快速导航卡片：

**【插入图片位置13】**: 快速导航卡片区域

#### 功能卡片：

1. **数据导入卡片**
   - 图标：📥 导入
   - 功能：导入Excel点位表文件
   - 点击跳转到数据导入界面

2. **测试区域卡片**
   - 图标：🧪 实验
   - 功能：管理测试批次和执行测试
   - 显示当前活跃批次数量

3. **手动测试卡片**
   - 图标：🔧 工具
   - 功能：手动控制和测试通道
   - 适用于调试和验证

4. **测试报告卡片**
   - 图标：📊 图表
   - 功能：查看和导出测试结果
   - 显示最近测试统计

---

## 第四章 基础操作

### 4.1 数据导入管理

数据导入是测试流程的第一步，用于将Excel格式的点位配置文件导入系统。

#### 4.1.1 Excel模板准备

**支持的文件格式**：
- Excel 2007+ (.xlsx)
- Excel 97-2003 (.xls)

**【插入图片位置14】**: Excel模板示例截图

**必需字段（53个）**：

| 分类 | 字段名称 | 说明 | 示例 |
|------|----------|------|------|
| 基础信息 | 序号 | 通道序号 | 1 |
| | 模块 | 模块编号 | M1 |
| | 卡件 | 卡件位置 | S1 |
| | 通道 | 通道号 | 1 |
| | 变量名 | PLC变量名 | AI_01_01 |
| 通道属性 | 模块类型 | AI/AO/DI/DO | AI |
| | 供电类型 | 供电方式 | 24VDC |
| | 线制 | 接线方式 | 4线制 |
| | 数据类型 | 数据类型 | Float |
| 量程配置 | 量程下限 | 工程量下限 | 0.0 |
| | 量程上限 | 工程量上限 | 100.0 |
| 报警配置 | SLL设定值 | 低低报警值 | 5.0 |
| | SL设定值 | 低报警值 | 10.0 |
| | SH设定值 | 高报警值 | 90.0 |
| | SHH设定值 | 高高报警值 | 95.0 |
| PLC地址 | 绝对地址 | PLC内部地址 | %IW0 |
| | 通讯地址 | Modbus地址 | 40001 |

#### 4.1.2 导入操作步骤

1. **进入数据导入界面**
   - 点击主菜单"数据导入"
   - 或从仪表盘点击"数据导入"卡片

**【插入图片位置15】**: 数据导入主界面

2. **选择Excel文件**
   - 点击"选择文件"按钮
   - 浏览并选择Excel文件
   - 系统显示文件基本信息

**【插入图片位置16】**: 文件选择对话框

3. **配置导入参数**
   - **工作表选择**：选择包含数据的工作表
   - **起始行号**：数据开始的行号（默认第2行）
   - **批次信息**：
     - 批次名称：Test_Batch_20250121
     - 产品型号：PLC_Controller_V2.0
     - 序列号：SN20250121001
     - 客户名称：ABC工厂
     - 操作员：张三

**【插入图片位置17】**: 导入参数配置界面

4. **数据预览和验证**
   - 系统自动解析文件内容
   - 显示数据预览表格
   - 标记验证错误和警告

**【插入图片位置18】**: 数据预览界面

**验证规则**：
- ✅ 必填字段完整性检查
- ✅ 数据类型格式验证
- ✅ 地址重复性检查
- ✅ 量程逻辑性验证
- ✅ 报警值合理性检查

5. **确认导入**
   - 检查验证结果
   - 解决错误和警告
   - 点击"开始导入"

**【插入图片位置19】**: 导入进度界面

6. **导入完成**
   - 查看导入统计信息
   - 点击"查看批次"进入测试区域

**【插入图片位置20】**: 导入完成总结界面

#### 4.1.3 常见导入问题

**问题1：文件格式不支持**
- 错误信息：不支持的文件格式
- 解决方法：确保文件为.xlsx或.xls格式

**问题2：必填字段缺失**
- 错误信息：缺少必填字段"XXX"
- 解决方法：检查Excel文件，补充缺失字段

**问题3：地址重复**
- 错误信息：通讯地址重复
- 解决方法：检查并修正重复的地址配置

### 4.2 测试PLC配置

测试PLC配置用于管理测试系统中的PLC设备连接和通道映射。

#### 4.2.1 PLC设备管理

1. **进入配置界面**
   - 点击主菜单"测试PLC配置"

**【插入图片位置21】**: PLC配置主界面

2. **查看现有设备**
   - 设备列表显示所有已配置的PLC
   - 状态栏显示连接状态
   - 支持启用/禁用设备

#### 4.2.2 添加新设备

1. **点击"添加PLC"按钮**

**【插入图片位置22】**: 添加PLC对话框

2. **填写基本信息**
   ```
   设备名称：TestPLC_Station1
   设备类型：Modbus TCP
   IP地址：192.168.1.100
   端口号：502
   设备角色：测试PLC
   ```

3. **配置连接参数**
   ```
   连接超时：5000 ms
   重试次数：3 次
   字节序：ABCD (大端)
   零基址：启用
   ```

4. **测试连接**
   - 点击"测试连接"按钮
   - 系统验证网络连通性
   - 显示连接测试结果

**【插入图片位置23】**: 连接测试结果

5. **保存配置**
   - 确认信息无误后点击"确定"
   - 系统自动保存配置

#### 4.2.3 通道地址映射

AO通道量程寄存器映射配置：

**【插入图片位置24】**: 通道映射配置界面

**默认映射表**：
| 通道标识 | 寄存器地址 | 说明 |
|----------|------------|------|
| AO1_1_RANGE | 45601 | AO卡1通道1量程 |
| AO1_2_RANGE | 45603 | AO卡1通道2量程 |
| AO1_3_RANGE | 45605 | AO卡1通道3量程 |
| ... | ... | ... |
| AO2_8_RANGE | 45631 | AO卡2通道8量程 |

**配置步骤**：
1. 选择AO通道
2. 输入对应的量程寄存器地址
3. 验证地址有效性
4. 保存映射配置

#### 4.2.4 高级配置

1. **协议参数**
   - Modbus单元ID：1
   - 读取超时：3000ms
   - 写入超时：5000ms

2. **数据格式**
   - 浮点数格式：IEEE 754
   - 整数格式：16位/32位
   - 字符串编码：UTF-8

3. **错误处理**
   - 自动重连：启用
   - 错误重试：启用
   - 异常日志：详细级别

### 4.3 测试批次管理

测试批次是组织和管理测试任务的基本单位。

#### 4.3.1 查看测试批次

1. **进入测试区域**
   - 点击主菜单"测试区域"

**【插入图片位置25】**: 测试区域主界面

2. **批次列表显示**
   - 批次名称和基本信息
   - 测试进度和状态
   - 创建时间和操作员
   - 点位统计信息

#### 4.3.2 批次详细信息

**【插入图片位置26】**: 批次详情界面

点击批次名称查看详细信息：

1. **基本信息**
   ```
   批次名称：Test_Batch_20250121
   产品型号：PLC_Controller_V2.0
   序列号：SN20250121001
   客户名称：ABC工厂
   操作员：张三
   创建时间：2025-01-21 09:30:25
   ```

2. **统计信息**
   ```
   总点位数：256
   已测试：128
   测试通过：120
   测试失败：8
   跳过测试：0
   当前进度：50.0%
   ```

3. **测试配置**
   ```
   测试类型：完整测试
   测试PLC：TestPLC_Station1
   被测PLC：ProductionPLC_01
   测试模式：自动
   ```

#### 4.3.3 批次操作

**可用操作**：

1. **开始测试**
   - 启动批次的自动测试
   - 前提：PLC连接正常

2. **暂停测试**
   - 暂停当前进行的测试
   - 保留当前进度

3. **停止测试**
   - 终止测试并保存结果
   - 可稍后继续

4. **重置批次**
   - 清除所有测试结果
   - 恢复到初始状态

5. **删除批次**
   - 删除批次及其所有数据
   - 操作不可恢复

**【插入图片位置27】**: 批次操作菜单

### 4.4 测试执行操作

测试执行是系统的核心功能，支持自动化测试和实时监控。

#### 4.4.1 启动测试

1. **选择测试批次**
   - 在测试区域选择要测试的批次
   - 确认批次状态为"就绪"

2. **检查前置条件**
   - ✅ 测试PLC连接正常
   - ✅ 被测PLC连接正常
   - ✅ 批次数据完整
   - ✅ 没有其他测试进行中

**【插入图片位置28】**: 测试前置条件检查

3. **启动测试**
   - 点击"开始测试"按钮
   - 系统显示确认对话框
   - 确认后开始自动测试

#### 4.4.2 测试进度监控

**【插入图片位置29】**: 测试进度监控界面

1. **总体进度**
   - 进度条显示完成百分比
   - 实时更新测试状态
   - 预估剩余时间

2. **当前测试通道**
   - 显示正在测试的通道信息
   - 包括通道名称、类型、地址
   - 当前测试步骤说明

3. **实时日志**
   - 滚动显示测试日志
   - 包括成功、失败、警告信息
   - 支持日志级别过滤

4. **统计信息**
   ```
   总计：256个点位
   已完成：128个
   成功：120个
   失败：8个
   跳过：0个
   成功率：93.75%
   ```

#### 4.4.3 测试类型说明

**AI（模拟量输入）测试**：
1. 硬点测试：验证通道连通性
2. 量程测试：0%、25%、50%、75%、100%点测试
3. 报警测试：SLL、SL、SH、SHH四级报警
4. 维护功能测试：维护值设定和使能

**AO（模拟量输出）测试**：
1. 量程设定：配置输出量程
2. 输出测试：设定输出值并验证
3. 精度测试：检查输出精度
4. 保持测试：验证输出稳定性

**DI（数字量输入）测试**：
1. 硬点测试：0/1状态测试
2. 响应时间：状态变化响应时间
3. 抗干扰：干扰环境下的稳定性

**DO（数字量输出）测试**：
1. 输出控制：0/1状态输出
2. 负载能力：驱动能力测试
3. 响应速度：输出切换时间

#### 4.4.4 测试控制操作

**【插入图片位置30】**: 测试控制面板

**可用控制**：

1. **暂停/恢复**
   - 临时暂停测试进程
   - 保持当前状态和进度
   - 点击恢复继续测试

2. **跳过当前**
   - 跳过当前正在测试的通道
   - 标记为"跳过"状态
   - 继续下一个通道

3. **停止测试**
   - 完全停止测试进程
   - 保存当前所有结果
   - 可稍后继续未完成的测试

4. **紧急停止**
   - 立即终止所有测试操作
   - 用于紧急情况
   - 可能丢失部分测试数据

#### 4.4.5 异常处理

**通信异常**：
- 自动重连机制
- 重试次数限制
- 错误日志记录

**测试失败**：
- 详细错误信息记录
- 失败原因分析
- 手动重试选项

**【插入图片位置31】**: 异常处理对话框

**系统异常**：
- 自动数据保护
- 异常恢复机制
- 技术支持联系方式

---

## 第五章 高级功能

### 5.1 手动测试功能

手动测试功能为用户提供了单点调试和验证的能力，特别适用于故障诊断和设备调试场景。

#### 5.1.1 手动测试界面

**【插入图片位置32】**: 手动测试主界面

进入手动测试：
1. 在测试区域点击"手动测试"按钮
2. 或从快速导航进入

界面布局：
- **左侧**：通道选择面板
- **中间**：测试操作区域
- **右侧**：实时数据显示

#### 5.1.2 AI通道手动测试

**【插入图片位置33】**: AI通道手动测试界面

**操作步骤**：

1. **选择AI通道**
   - 从左侧列表选择AI通道
   - 显示通道基本信息

2. **配置测试参数**
   ```
   通道地址：40001
   数据类型：Float
   工程量程：0.0 ~ 100.0
   工程单位：℃
   ```

3. **执行读取测试**
   - 点击"读取当前值"
   - 显示原始值和工程值
   - 实时刷新（可设置间隔）

4. **量程标定测试**
   - 输入标准信号（4mA/20mA）
   - 读取对应的工程值
   - 验证线性度和精度

#### 5.1.3 AO通道手动测试

**【插入图片位置34】**: AO通道手动测试界面

**操作步骤**：

1. **选择AO通道**
   - 选择要测试的AO通道
   - 查看当前配置信息

2. **设置量程**
   - 配置输出量程范围
   - 例如：4-20mA 对应 0-100℃

3. **输出测试**
   - 输入目标工程值：25.0℃
   - 系统计算对应电流值：8.0mA
   - 点击"输出"按钮执行

4. **验证输出**
   - 使用万用表测量实际输出
   - 对比期望值和实际值
   - 记录误差信息

#### 5.1.4 DI通道手动测试

**【插入图片位置35】**: DI通道手动测试界面

**操作步骤**：

1. **选择DI通道**
   - 选择数字量输入通道
   - 查看通道配置

2. **状态读取**
   - 实时显示通道状态（0/1）
   - 支持连续监控模式

3. **变化检测**
   - 手动改变输入信号
   - 观察状态变化
   - 记录响应时间

#### 5.1.5 DO通道手动测试

**【插入图片位置36】**: DO通道手动测试界面

**操作步骤**：

1. **选择DO通道**
   - 选择数字量输出通道
   - 确认负载连接

2. **输出控制**
   - 点击"输出1"或"输出0"
   - 观察负载响应
   - 验证输出正确性

3. **频率测试**
   - 设置切换频率
   - 自动进行0/1切换
   - 测试响应速度

#### 5.1.6 批量手动测试

**【插入图片位置37】**: 批量手动测试界面

**功能特点**：
- 支持多通道同时测试
- 批量设置相同参数
- 并行执行测试操作
- 统一结果展示

### 5.2 上位机功能检查

上位机功能检查用于验证整个控制系统的完整性和功能正确性。

#### 5.2.1 全局功能测试

**【插入图片位置38】**: 全局功能测试界面

**测试项目**：

1. **通信连接测试**
   - 测试PLC通信状态
   - 验证网络连通性
   - 检查协议兼容性

2. **数据一致性测试**
   - 验证数据库完整性
   - 检查配置文件正确性
   - 确认地址映射准确性

3. **系统响应测试**
   - 测试界面响应速度
   - 验证操作响应时间
   - 检查内存使用情况

#### 5.2.2 功能模块验证

**【插入图片位置39】**: 功能模块验证界面

**验证项目**：

1. **数据导入模块**
   - 测试Excel文件解析
   - 验证数据格式检查
   - 确认批次创建功能

2. **测试执行模块**
   - 验证测试流程控制
   - 检查错误处理机制
   - 确认进度跟踪准确性

3. **报告生成模块**
   - 测试报告模板加载
   - 验证数据统计计算
   - 确认导出功能正常

#### 5.2.3 系统自检

**【插入图片位置40】**: 系统自检界面

**自检内容**：

1. **配置文件检查**
   ```
   ✅ app_settings.json - 正常
   ✅ PLC配置文件 - 正常
   ⚠️ 备份配置 - 缺失
   ```

2. **数据库检查**
   ```
   ✅ 数据库连接 - 正常
   ✅ 表结构完整性 - 正常
   ✅ 索引状态 - 正常
   ```

3. **网络连接检查**
   ```
   ✅ 测试PLC连接 - 正常
   ❌ 被测PLC连接 - 失败
   ```

#### 5.2.4 性能监控

**【插入图片位置41】**: 性能监控界面

**监控指标**：

1. **系统资源**
   - CPU使用率：15%
   - 内存使用：256MB/8GB
   - 磁盘空间：2.5GB可用

2. **网络状态**
   - 网络延迟：2ms
   - 数据包丢失：0%
   - 带宽使用：1.2Mbps

3. **测试性能**
   - 平均测试时间：2.5秒/点
   - 成功率：98.5%
   - 异常重试率：1.2%

### 5.3 测试结果分析

测试结果分析提供了详细的数据统计和趋势分析功能。

#### 5.3.1 结果概览

**【插入图片位置42】**: 测试结果概览界面

**统计维度**：

1. **按通道类型统计**
   ```
   AI通道：128个，通过率 95.3%
   AO通道：64个，通过率 98.4%
   DI通道：32个，通过率 100%
   DO通道：32个，通过率 96.9%
   ```

2. **按测试状态统计**
   ```
   已测试：240个 (93.8%)
   未测试：16个 (6.2%)
   通过：232个 (96.7%)
   失败：8个 (3.3%)
   ```

3. **按时间统计**
   ```
   总测试时间：2小时15分钟
   平均每点时间：2.3秒
   最长测试点：15.6秒
   最短测试点：0.8秒
   ```

#### 5.3.2 失败分析

**【插入图片位置43】**: 失败分析界面

**失败分类**：

1. **通信失败**
   - 数量：3个
   - 原因：网络超时
   - 建议：检查网络连接

2. **量程错误**
   - 数量：2个
   - 原因：量程配置错误
   - 建议：修正量程设置

3. **报警异常**
   - 数量：2个
   - 原因：报警值设置不当
   - 建议：重新配置报警值

4. **硬件故障**
   - 数量：1个
   - 原因：通道硬件故障
   - 建议：更换硬件模块

#### 5.3.3 趋势分析

**【插入图片位置44】**: 趋势分析图表

**分析图表**：

1. **成功率趋势图**
   - X轴：测试时间
   - Y轴：成功率
   - 显示测试过程中成功率变化

2. **测试时间分布图**
   - 显示各通道测试时间分布
   - 识别异常耗时的测试项

3. **错误类型分布图**
   - 饼图显示各类错误占比
   - 帮助定位主要问题

#### 5.3.4 详细记录查看

**【插入图片位置45】**: 详细记录查看界面

**记录内容**：

1. **通道级记录**
   - 通道基本信息
   - 测试参数配置
   - 每个测试步骤结果
   - 错误信息和备注

2. **原始数据记录**
   - 读取的原始数值
   - 计算的工程值
   - 时间戳信息
   - JSON格式详细数据

3. **操作日志**
   - 用户操作记录
   - 系统自动操作
   - 异常处理记录

### 5.4 报告生成与导出

报告生成功能支持多种格式的测试报告输出，满足不同的文档需求。

#### 5.4.1 报告模板

**【插入图片位置46】**: 报告模板选择界面

**可用模板**：

1. **标准测试报告**
   - 适用于常规FAT测试
   - 包含完整的测试数据
   - PDF格式输出

2. **简化测试报告**
   - 仅包含关键信息
   - 适用于快速验证
   - Word/PDF格式

3. **详细技术报告**
   - 包含所有技术细节
   - 适用于技术分析
   - 多格式支持

4. **客户定制报告**
   - 根据客户要求定制
   - 可配置内容和格式
   - 支持企业LOGO

#### 5.4.2 报告配置

**【插入图片位置47】**: 报告配置界面

**配置选项**：

1. **基本信息**
   ```
   报告标题：FAT测试报告
   项目名称：ABC工厂PLC系统
   测试日期：2025-01-21
   测试人员：张三
   审核人员：李四
   ```

2. **内容选择**
   - ☑️ 测试概览
   - ☑️ 测试结果统计
   - ☑️ 失败项详细分析
   - ☑️ 原始数据附录
   - ☑️ 设备配置信息

3. **格式设置**
   - 页面大小：A4
   - 页面方向：纵向
   - 字体大小：12pt
   - 边距：2.5cm

#### 5.4.3 数据导出

**【插入图片位置48】**: 数据导出界面

**导出格式**：

1. **Excel格式**
   - 多工作表结构
   - 包含原始数据和统计
   - 支持图表和格式

2. **CSV格式**
   - 纯数据格式
   - 便于其他系统导入
   - 支持自定义分隔符

3. **JSON格式**
   - 结构化数据
   - 便于程序处理
   - 包含完整元数据

4. **XML格式**
   - 标准化数据交换
   - 支持自定义Schema
   - 便于系统集成

#### 5.4.4 自动化报告

**【插入图片位置49】**: 自动化报告配置

**自动化选项**：

1. **定时生成**
   - 设置生成时间间隔
   - 自动保存到指定目录
   - 支持邮件发送

2. **触发生成**
   - 测试完成后自动生成
   - 基于特定条件触发
   - 支持多种输出格式

3. **批量处理**
   - 多个批次合并报告
   - 历史数据批量导出
   - 支持数据筛选

---

## 第六章 故障排除

### 6.1 常见问题

#### 6.1.1 连接问题

**问题1：无法连接到测试PLC**

**【插入图片位置50】**: PLC连接错误界面

**现象**：
- 状态栏显示"测试PLC：未连接"
- 连接测试失败
- 测试无法启动

**可能原因**：
1. 网络连接问题
2. IP地址配置错误
3. 端口配置错误
4. 防火墙阻止连接
5. PLC设备故障

**解决步骤**：

1. **检查网络连接**
   ```
   cmd > ping 192.168.1.100
   ```
   - 如果ping不通，检查网线连接
   - 确认IP地址是否正确

2. **检查PLC配置**
   - 进入"测试PLC配置"界面
   - 验证IP地址和端口设置
   - 测试连接功能

3. **检查防火墙设置**
   - Windows防火墙设置
   - 允许程序通过防火墙
   - 开放Modbus端口(502)

4. **检查PLC设备**
   - 确认PLC上电正常
   - 检查网络模块状态
   - 验证Modbus服务启用

**问题2：连接频繁断开**

**现象**：
- 连接状态不稳定
- 测试中途中断
- 通信超时错误

**解决方法**：
1. 增加连接超时时间
2. 检查网络稳定性
3. 减少并发通信数量
4. 更新网络驱动程序

#### 6.1.2 数据导入问题

**问题1：Excel文件无法解析**

**【插入图片位置51】**: Excel解析错误界面

**现象**：
- 文件选择后报错
- 数据预览为空
- 提示格式不支持

**解决方法**：
1. 确认文件格式为.xlsx或.xls
2. 检查文件是否损坏
3. 确认文件未被其他程序占用
4. 重新保存Excel文件

**问题2：数据验证失败**

**现象**：
- 大量验证错误
- 必填字段缺失
- 数据格式不正确

**解决方法**：
1. 对照Excel模板检查字段
2. 确认数据类型正确
3. 检查地址重复问题
4. 修正量程和报警配置

#### 6.1.3 测试执行问题

**问题1：测试无法启动**

**现象**：
- 点击开始测试无响应
- 提示前置条件不满足
- 按钮显示为灰色

**解决方法**：
1. 检查PLC连接状态
2. 确认批次数据完整
3. 检查系统权限
4. 重启应用程序

**问题2：测试中途停止**

**现象**：
- 测试进度停滞
- 系统报告错误
- 无法继续测试

**解决方法**：
1. 查看错误日志
2. 检查PLC通信
3. 恢复测试状态
4. 手动重试失败项

### 6.2 错误代码说明

#### 6.2.1 系统错误代码

| 错误代码 | 错误描述 | 解决方法 |
|----------|----------|----------|
| SYS_001 | 数据库连接失败 | 检查数据库文件权限 |
| SYS_002 | 配置文件损坏 | 恢复默认配置 |
| SYS_003 | 内存不足 | 关闭其他程序或增加内存 |
| SYS_004 | 磁盘空间不足 | 清理磁盘空间 |
| SYS_005 | 系统文件缺失 | 重新安装软件 |

#### 6.2.2 通信错误代码

| 错误代码 | 错误描述 | 解决方法 |
|----------|----------|----------|
| COMM_001 | 连接超时 | 检查网络连接 |
| COMM_002 | 响应超时 | 增加超时时间 |
| COMM_003 | 协议错误 | 检查PLC协议设置 |
| COMM_004 | 地址无效 | 验证寄存器地址 |
| COMM_005 | 权限不足 | 检查PLC安全设置 |

#### 6.2.3 测试错误代码

| 错误代码 | 错误描述 | 解决方法 |
|----------|----------|----------|
| TEST_001 | 量程配置错误 | 检查量程设置 |
| TEST_002 | 报警值无效 | 修正报警配置 |
| TEST_003 | 硬件故障 | 检查硬件连接 |
| TEST_004 | 数据类型不匹配 | 确认数据类型配置 |
| TEST_005 | 测试超时 | 检查测试流程 |

### 6.3 系统日志查看

#### 6.3.1 日志文件位置

**日志目录**：
```
C:\Program Files\FactoryTesting\logs\
├── app.log          # 应用程序日志
├── test.log         # 测试执行日志
├── comm.log         # 通信日志
├── error.log        # 错误日志
└── debug.log        # 调试日志
```

#### 6.3.2 日志级别

**【插入图片位置52】**: 日志查看界面

**日志级别说明**：
- **ERROR**: 严重错误，影响系统功能
- **WARN**: 警告信息，可能存在问题
- **INFO**: 一般信息，记录重要操作
- **DEBUG**: 调试信息，详细执行过程
- **TRACE**: 跟踪信息，最详细的记录

#### 6.3.3 日志查看工具

**系统内置日志查看器**：
1. 在主菜单选择"帮助" → "系统日志"
2. 选择日志文件和时间范围
3. 设置过滤条件
4. 实时刷新或导出日志

**第三方工具**：
- Notepad++：文本编辑器
- LogExpert：专业日志查看器
- Tail：实时日志监控

### 6.4 技术支持

#### 6.4.1 联系方式

**技术支持热线**：
- 电话：400-XXX-XXXX
- 邮箱：support@company.com
- 微信：factory-test-support

**支持时间**：
- 工作日：09:00-18:00
- 紧急支持：24小时待命

#### 6.4.2 远程协助

**远程支持工具**：
1. TeamViewer
2. 向日葵远程控制
3. Windows远程桌面

**远程协助流程**：
1. 联系技术支持
2. 提供问题描述
3. 安装远程工具
4. 建立远程连接
5. 协助解决问题

#### 6.4.3 问题反馈

**反馈信息包含**：
1. 问题详细描述
2. 操作步骤重现
3. 错误截图或录屏
4. 系统日志文件
5. 配置文件信息

**【插入图片位置53】**: 问题反馈表单

---

## 第七章 附录

### 7.1 Excel模板格式

#### 7.1.1 标准模板结构

**【插入图片位置54】**: Excel模板完整示例

**工作表要求**：
- 工作表名称：通道配置
- 数据起始行：第2行
- 表头必须为中文

#### 7.1.2 必填字段清单

**基础信息字段（8个）**：
1. 序号 - 通道序号
2. 模块 - 模块编号
3. 卡件 - 卡件位置
4. 通道 - 通道号
5. 变量名 - PLC变量名
6. 描述 - 通道描述
7. 工程单位 - 测量单位
8. 备注 - 其他说明

**通道属性字段（6个）**：
9. 模块类型 - AI/AO/DI/DO
10. 供电类型 - 供电方式
11. 线制 - 接线方式
12. 数据类型 - 数据类型
13. 通道类型 - 有源/无源
14. 信号类型 - 电流/电压/数字

**量程配置字段（4个）**：
15. 量程下限 - 工程量下限
16. 量程上限 - 工程量上限
17. 信号下限 - 信号下限
18. 信号上限 - 信号上限

**报警配置字段（16个）**：
19. SLL设定值 - 低低报警值
20. SLL设定点位 - 低低报警点位
21. SLL_PLC地址 - 低低报警PLC地址
22. SLL通讯地址 - 低低报警通讯地址
23-26. SL设定相关字段
27-30. SH设定相关字段
31-34. SHH设定相关字段

**维护功能字段（4个）**：
35. 维护值设定 - 维护值
36. 维护值设定点位 - 维护点位
37. 维护使能PLC地址 - 维护使能地址
38. 维护使能通讯地址 - 维护使能通讯地址

**PLC地址字段（15个）**：
39. 绝对地址 - PLC内部地址
40. 通讯地址 - Modbus地址
41-53. 其他地址相关字段

#### 7.1.3 数据验证规则

**格式验证**：
```
序号：正整数，1-9999
模块类型：AI/AO/DI/DO/AI_P/AO_P/DI_P/DO_P
数据类型：Bool/Float/Int/String/Double
量程：数值类型，下限<上限
地址：符合Modbus地址规范
```

**逻辑验证**：
```
报警值：SLL<SL<SH<SHH
报警值范围：在量程范围内
地址唯一性：同类型地址不重复
必填字段：不能为空
```

### 7.2 PLC地址映射表

#### 7.2.1 Modbus地址映射

**【插入图片位置55】**: Modbus地址映射表

**地址分类**：

| 功能码 | 地址范围 | 数据类型 | 说明 |
|--------|----------|----------|------|
| 01 | 00001-09999 | Coil | 线圈状态 |
| 02 | 10001-19999 | Input | 离散输入 |
| 03 | 30001-39999 | Input Reg | 输入寄存器 |
| 04 | 40001-49999 | Holding Reg | 保持寄存器 |

#### 7.2.2 AO量程寄存器映射

**默认映射配置**：

| 通道 | 寄存器地址 | 十六进制 | 说明 |
|------|------------|----------|------|
| AO1_1 | 45601 | 0xB221 | 第1卡第1通道 |
| AO1_2 | 45603 | 0xB223 | 第1卡第2通道 |
| AO1_3 | 45605 | 0xB225 | 第1卡第3通道 |
| AO1_4 | 45607 | 0xB227 | 第1卡第4通道 |
| AO1_5 | 45609 | 0xB229 | 第1卡第5通道 |
| AO1_6 | 45611 | 0xB22B | 第1卡第6通道 |
| AO1_7 | 45613 | 0xB22D | 第1卡第7通道 |
| AO1_8 | 45615 | 0xB22F | 第1卡第8通道 |
| AO2_1 | 45617 | 0xB231 | 第2卡第1通道 |
| AO2_2 | 45619 | 0xB233 | 第2卡第2通道 |
| ... | ... | ... | ... |

#### 7.2.3 数据类型映射

**数据格式**：

| 类型 | 字节数 | 字节序 | 范围 |
|------|--------|--------|------|
| Bool | 1 | - | 0/1 |
| Int16 | 2 | ABCD | -32768~32767 |
| UInt16 | 2 | ABCD | 0~65535 |
| Int32 | 4 | ABCD | -2^31~2^31-1 |
| Float | 4 | ABCD | IEEE 754 |
| Double | 8 | ABCD | IEEE 754 |

### 7.3 系统配置文件

#### 7.3.1 应用配置文件

**文件位置**：`config/app_settings.json`

**【插入图片位置56】**: 配置文件编辑界面

**配置参数说明**：

```json
{
  "id": "default_settings",
  "theme": "light",                    // 界面主题
  "plc_ip_address": "127.0.0.1",      // 默认PLC IP
  "plc_port": 502,                     // 默认端口
  "default_operator_name": null,       // 默认操作员
  "auto_save_interval_minutes": 5,     // 自动保存间隔
  "recent_projects": [],               // 最近项目
  "last_backup_time": null,            // 最后备份时间
  "log_level": "INFO",                 // 日志级别
  "max_concurrent_tests": 10,          // 最大并发测试数
  "test_timeout_seconds": 30,          // 测试超时时间
  "retry_count": 3,                    // 重试次数
  "enable_auto_report": true,          // 自动报告
  "report_template": "standard"        // 报告模板
}
```

#### 7.3.2 PLC配置文件

**数据库表**：`plc_connection_configs`

**配置示例**：
```json
{
  "name": "TestPLC_Station1",
  "plc_type": "ModbusTcp",
  "ip_address": "192.168.1.100",
  "port": 502,
  "timeout": 5000,
  "retry_count": 3,
  "byte_order": "ABCD",
  "zero_based_address": true,
  "is_test_plc": true,
  "is_enabled": true
}
```

#### 7.3.3 测试配置文件

**默认测试参数**：
```json
{
  "test_intervals": {
    "ai_test_points": [0, 25, 50, 75, 100],
    "ao_test_points": [0, 25, 50, 75, 100],
    "di_test_cycles": 5,
    "do_test_cycles": 5
  },
  "tolerance": {
    "ai_tolerance_percent": 0.5,
    "ao_tolerance_percent": 0.5,
    "response_time_ms": 1000
  },
  "alarm_test": {
    "enable_alarm_test": true,
    "alarm_hold_time_ms": 2000,
    "alarm_recovery_time_ms": 1000
  }
}
```

### 7.4 数据库备份恢复

#### 7.4.1 数据库备份

**手动备份**：
1. 关闭应用程序
2. 复制数据库文件
   ```
   源文件：data/factory_testing_data.sqlite
   目标：backup/factory_testing_data_20250121.sqlite
   ```

**【插入图片位置57】**: 备份操作界面

**自动备份配置**：
```json
{
  "auto_backup": {
    "enabled": true,
    "interval_hours": 24,
    "backup_path": "./backup/",
    "max_backup_files": 30,
    "compress": true
  }
}
```

#### 7.4.2 数据库恢复

**恢复步骤**：
1. 关闭应用程序
2. 备份当前数据库
3. 用备份文件替换当前数据库
4. 重启应用程序
5. 验证数据完整性

**【插入图片位置58】**: 恢复操作界面

#### 7.4.3 数据迁移

**版本升级迁移**：
- 系统自动检测数据库版本
- 执行必要的结构升级
- 保持数据兼容性
- 生成迁移日志

**迁移日志示例**：
```
2025-01-21 10:30:00 [INFO] 开始数据库迁移
2025-01-21 10:30:01 [INFO] 当前版本: 1.0, 目标版本: 1.1
2025-01-21 10:30:02 [INFO] 添加新表: test_configurations
2025-01-21 10:30:03 [INFO] 更新表结构: channel_test_instances
2025-01-21 10:30:04 [INFO] 迁移完成，耗时: 4秒
```

---

## 结语

本操作手册详细介绍了工厂测试系统的各项功能和操作方法。如在使用过程中遇到问题，请参考故障排除章节或联系技术支持。

**文档版本**: 1.0.0  
**最后更新**: 2025年1月21日  
**技术支持**: support@company.com  

---

**版权声明**: 本文档版权归开发公司所有，未经授权不得复制或传播。