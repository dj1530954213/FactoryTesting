# 🏭 FAT_TEST 使用指南

## 📋 概述

FAT_TEST (Factory Acceptance Testing) 是一个基于 Rust + Angular + Tauri 技术栈的工厂验收测试桌面应用程序。本指南将帮助您快速上手使用该系统。

## 🚀 快速开始

### 1. 启动应用

#### 开发模式启动
```bash
# 进入项目目录
cd FactoryTesting

# 启动开发模式
npm run tauri:dev
```

#### 生产模式启动
```bash
# 构建生产版本
npm run tauri:build

# 运行生成的可执行文件
./src-tauri/target/release/FactoryTesting.exe
```

### 2. 应用界面

启动后，您将看到现代化的Angular界面，包含以下主要模块：

- 🏠 **仪表板** - 系统状态监控
- 📊 **数据导入** - Excel文件导入和管理
- ⚡ **测试执行** - 批次测试管理
- 📋 **批次管理** - 测试批次CRUD操作
- 🔧 **手动测试** - 单点测试功能

## 📊 核心功能使用

### 1. 数据导入功能

#### Excel文件导入
1. 点击 **数据导入** 模块
2. 选择 **导入Excel文件** 按钮
3. 选择包含通道定义的Excel文件（支持.xlsx/.xls格式）
4. 系统将自动解析文件并显示预览
5. 确认数据无误后点击 **确认导入**

#### 支持的Excel格式
Excel文件应包含以下列：
- **Tag** - 通道标签
- **Variable Description** - 变量描述
- **Station Name** - 站点名称
- **Module Name** - 模块名称
- **Module Type** - 模块类型（AI/DI/AO/DO）
- **Channel Number** - 通道号
- **Data Type** - 数据类型
- **PLC Communication Address** - PLC通信地址

### 2. 批次管理

#### 创建测试批次
1. 进入 **批次管理** 模块
2. 点击 **创建新批次** 按钮
3. 填写批次信息：
   - 产品型号
   - 序列号
   - 客户名称
   - 操作员姓名
4. 选择要包含的通道定义
5. 点击 **创建批次**

#### 查看批次信息
- 在批次列表中查看所有已创建的批次
- 点击批次可查看详细信息
- 支持批次的编辑和删除操作

### 3. 测试执行

#### 开始批次测试
1. 进入 **测试执行** 模块
2. 选择要测试的批次
3. 点击 **开始测试** 按钮
4. 系统将自动执行所有通道的测试

#### 监控测试进度
- 实时查看测试进度条
- 查看每个通道的测试状态
- 监控测试结果和错误信息

#### 测试控制
- **暂停测试** - 暂停当前测试
- **恢复测试** - 恢复暂停的测试
- **停止测试** - 完全停止测试

### 4. 手动测试

#### 单点测试
1. 进入 **手动测试** 模块
2. 选择要测试的通道
3. 选择测试类型：
   - **读取通道值** - 从PLC读取当前值
   - **写入通道值** - 向PLC写入指定值
   - **执行子测试** - 执行特定的测试步骤

#### 测试参数配置
- 设置测试参数（如百分比、容差等）
- 配置PLC通信地址
- 选择数据类型

### 5. 报告生成

#### 生成测试报告
1. 完成测试后，进入报告生成模块
2. 选择要生成报告的批次
3. 选择报告格式：
   - **PDF报告** - 专业格式的测试报告
   - **Excel报告** - 数据分析友好的表格报告
4. 点击 **生成报告**

#### 报告内容
- 测试批次信息
- 所有通道的测试结果
- 测试统计和汇总
- 错误和异常记录

## 🔧 高级功能

### 1. 系统状态监控

在仪表板中可以查看：
- 系统健康状态
- 活跃测试任务数量
- 系统运行时间
- 内存使用情况

### 2. 配置管理

#### PLC通信配置
- 配置PLC连接参数
- 设置通信超时时间
- 配置重试次数

#### 测试参数配置
- 设置最大并发测试数
- 配置测试超时时间
- 设置默认容差值

### 3. 数据管理

#### 通道定义管理
- 添加、编辑、删除通道定义
- 批量导入通道定义
- 导出通道定义到Excel

#### 历史数据查询
- 查看历史测试记录
- 按时间范围筛选
- 按批次或通道筛选

## 🧪 测试和验证

### 1. 功能测试

#### 使用集成测试页面
1. 在浏览器中打开 `integration_test.html`
2. 点击各个测试按钮验证功能
3. 查看测试结果和日志

#### 使用简化测试页面
1. 在浏览器中打开 `simple_test.html`
2. 点击 **开始功能测试** 按钮
3. 观察自动化测试过程

### 2. 性能测试

#### 批量数据测试
- 导入大量通道定义（1000+）
- 创建大批次测试（100+通道）
- 监控系统性能表现

#### 并发测试
- 同时运行多个测试批次
- 监控系统资源使用
- 验证并发控制机制

## 🚨 故障排除

### 1. 常见问题

#### 应用启动失败
- 检查Node.js和Rust环境是否正确安装
- 确认所有依赖包已正确安装
- 查看控制台错误信息

#### Excel导入失败
- 检查Excel文件格式是否正确
- 确认文件路径是否存在
- 验证文件是否被其他程序占用

#### 测试执行失败
- 检查PLC连接状态
- 验证通道定义是否正确
- 查看错误日志信息

### 2. 日志查看

#### 应用日志
- 开发模式：控制台输出
- 生产模式：日志文件（logs目录）

#### 错误诊断
- 查看详细错误信息
- 检查堆栈跟踪
- 分析错误原因

### 3. 性能优化

#### 内存使用优化
- 定期清理完成的测试批次
- 避免同时运行过多测试
- 监控内存使用情况

#### 响应速度优化
- 减少不必要的数据查询
- 使用分页加载大量数据
- 优化UI渲染性能

## 📚 技术参考

### 1. 系统架构

#### 技术栈
- **后端**: Rust 1.85+ + Tauri 2.x
- **前端**: Angular 18+ + TypeScript 5.0+
- **UI组件**: NG-ZORRO (Ant Design)
- **数据库**: SQLite
- **通信**: Tauri IPC

#### 架构模式
- **分层架构**: Application → Domain → Infrastructure
- **依赖注入**: 服务间松耦合
- **事件驱动**: 异步事件处理
- **状态管理**: 集中式状态控制

### 2. API参考

#### Tauri Commands
系统提供30+个Tauri命令，涵盖：
- 测试协调（8个命令）
- 数据管理（8个命令）
- 通道状态管理（3个命令）
- 报告生成（7个命令）
- 手动测试（3个命令）
- 系统状态（1个命令）

#### 数据模型
- **ChannelPointDefinition** - 通道定义
- **ChannelTestInstance** - 测试实例
- **TestBatchInfo** - 批次信息
- **TestReport** - 测试报告

### 3. 扩展开发

#### 添加新的测试类型
1. 在 `specific_test_executors.rs` 中实现新的执行器
2. 在 `SubTestItem` 枚举中添加新类型
3. 更新前端UI支持新测试类型

#### 添加新的PLC协议
1. 实现 `IPlcCommunicationService` trait
2. 在配置中添加协议选择
3. 更新通信地址格式

#### 自定义报告模板
1. 在 `report_generation_service.rs` 中添加新模板
2. 实现模板渲染逻辑
3. 更新前端模板选择界面

## 📞 支持和帮助

### 1. 文档资源
- **技术文档**: `docs/` 目录
- **API文档**: 代码注释
- **开发记录**: 各阶段总结文档

### 2. 问题反馈
- 查看已知问题列表
- 提交新问题报告
- 参与讨论和改进

### 3. 版本更新
- 关注版本发布说明
- 了解新功能和改进
- 按照升级指南更新

---

## 🎯 总结

FAT_TEST 是一个功能完整、性能优秀的工厂验收测试系统。通过本指南，您应该能够：

1. ✅ **快速启动和使用应用**
2. ✅ **掌握核心功能操作**
3. ✅ **进行有效的故障排除**
4. ✅ **了解系统架构和扩展方式**

如果您在使用过程中遇到任何问题，请参考故障排除部分或查阅技术文档。

**祝您使用愉快！** 🎉

---

*文档版本: v1.0.0*  
*更新时间: 2025年5月26日*  
*适用版本: FAT_TEST v1.0.0-beta* 