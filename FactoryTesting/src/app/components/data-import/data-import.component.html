<div class="data-import-container simple-import">
  <h1>📥 数据导入</h1>

  <!-- 成功提示 -->
  <nz-alert
    *ngIf="previewData.length && !isLoading"
    nzType="success"
    nzShowIcon
    [nzMessage]="'导入成功：已解析 ' + previewData.length + ' 个点位，生成 ' + createdBatchesCount + ' 个批次'">
  </nz-alert>

  <!-- 操作按钮 -->
  <div class="import-actions" style="margin-top: 24px;">
    <button nz-button nzType="primary" (click)="selectFile()" [disabled]="isLoading">
      <span nz-icon nzType="upload"></span>
      导入Excel
    </button>

    <button nz-button nzType="default" style="margin-left: 12px;" (click)="startTesting()"
            [disabled]="!previewData.length || isCreatingBatch">
      <span nz-icon nzType="play-circle"></span>
      {{ isCreatingBatch ? '准备中...' : '开始测试' }}
    </button>
  </div>

  <!-- 加载指示 -->
  <div style="margin-top: 32px;" *ngIf="isLoading">
    <nz-spin nzTip="{{ loadingMessage || '处理中...' }}"></nz-spin>
  </div>
</div>
