<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAT_TEST å‰åç«¯é›†æˆæµ‹è¯•</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            color: #1890ff;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
        }
        .test-section h3 {
            color: #262626;
            margin-top: 0;
        }
        .button {
            background-color: #1890ff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .button:hover {
            background-color: #40a9ff;
        }
        .button:disabled {
            background-color: #d9d9d9;
            cursor: not-allowed;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            white-space: pre-wrap;
        }
        .success {
            background-color: #f6ffed;
            border: 1px solid #b7eb8f;
            color: #389e0d;
        }
        .error {
            background-color: #fff2f0;
            border: 1px solid #ffccc7;
            color: #cf1322;
        }
        .info {
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            color: #0958d9;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-connected {
            background-color: #52c41a;
        }
        .status-disconnected {
            background-color: #ff4d4f;
        }
        .status-unknown {
            background-color: #faad14;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ­ FAT_TEST å‰åç«¯é›†æˆæµ‹è¯•</h1>
            <p>æµ‹è¯• Rust åç«¯ä¸ Angular å‰ç«¯çš„ Tauri é€šä¿¡</p>
            <div id="connection-status">
                <span class="status-indicator status-unknown"></span>
                <span>è¿æ¥çŠ¶æ€æ£€æµ‹ä¸­...</span>
            </div>
        </div>

        <div class="grid">
            <!-- ç³»ç»ŸçŠ¶æ€æµ‹è¯• -->
            <div class="test-section">
                <h3>ğŸ”§ ç³»ç»ŸçŠ¶æ€æµ‹è¯•</h3>
                <button class="button" onclick="testSystemStatus()">è·å–ç³»ç»ŸçŠ¶æ€</button>
                <button class="button" onclick="testSystemHealth()">æ£€æŸ¥ç³»ç»Ÿå¥åº·</button>
                <div id="system-result" class="result info" style="display: none;"></div>
            </div>

            <!-- æ•°æ®ç®¡ç†æµ‹è¯• -->
            <div class="test-section">
                <h3>ğŸ“Š æ•°æ®ç®¡ç†æµ‹è¯•</h3>
                <button class="button" onclick="testGetAllDefinitions()">è·å–æ‰€æœ‰é€šé“å®šä¹‰</button>
                <button class="button" onclick="testGetAllBatches()">è·å–æ‰€æœ‰æ‰¹æ¬¡</button>
                <button class="button" onclick="testCreateTestInstance()">åˆ›å»ºæµ‹è¯•å®ä¾‹</button>
                <div id="data-result" class="result info" style="display: none;"></div>
            </div>

            <!-- Excelå¯¼å…¥æµ‹è¯• -->
            <div class="test-section">
                <h3>ğŸ“ Excelå¯¼å…¥æµ‹è¯•</h3>
                <button class="button" onclick="testExcelImport()">æµ‹è¯•Excelå¯¼å…¥</button>
                <button class="button" onclick="testCreateBatch()">åˆ›å»ºæµ‹è¯•æ‰¹æ¬¡</button>
                <div id="excel-result" class="result info" style="display: none;"></div>
            </div>

            <!-- æµ‹è¯•æ‰§è¡Œæµ‹è¯• -->
            <div class="test-section">
                <h3>âš¡ æµ‹è¯•æ‰§è¡Œæµ‹è¯•</h3>
                <button class="button" onclick="testStartBatch()">å¼€å§‹æ‰¹æ¬¡æµ‹è¯•</button>
                <button class="button" onclick="testGetProgress()">è·å–æµ‹è¯•è¿›åº¦</button>
                <button class="button" onclick="testStopBatch()">åœæ­¢æ‰¹æ¬¡æµ‹è¯•</button>
                <div id="execution-result" class="result info" style="display: none;"></div>
            </div>

            <!-- æŠ¥å‘Šç”Ÿæˆæµ‹è¯• -->
            <div class="test-section">
                <h3>ğŸ“‹ æŠ¥å‘Šç”Ÿæˆæµ‹è¯•</h3>
                <button class="button" onclick="testGetTemplates()">è·å–æŠ¥å‘Šæ¨¡æ¿</button>
                <button class="button" onclick="testGeneratePDF()">ç”ŸæˆPDFæŠ¥å‘Š</button>
                <button class="button" onclick="testGenerateExcel()">ç”ŸæˆExcelæŠ¥å‘Š</button>
                <div id="report-result" class="result info" style="display: none;"></div>
            </div>

            <!-- æ‰‹åŠ¨æµ‹è¯• -->
            <div class="test-section">
                <h3>ğŸ”§ æ‰‹åŠ¨æµ‹è¯•</h3>
                <button class="button" onclick="testManualSubTest()">æ‰§è¡Œæ‰‹åŠ¨å­æµ‹è¯•</button>
                <button class="button" onclick="testReadChannelValue()">è¯»å–é€šé“å€¼</button>
                <button class="button" onclick="testWriteChannelValue()">å†™å…¥é€šé“å€¼</button>
                <div id="manual-result" class="result info" style="display: none;"></div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“ æµ‹è¯•æ—¥å¿—</h3>
            <button class="button" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            <div id="test-log" class="result info" style="min-height: 200px;">
                æµ‹è¯•æ—¥å¿—å°†åœ¨è¿™é‡Œæ˜¾ç¤º...
            </div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥æ˜¯å¦åœ¨Tauriç¯å¢ƒä¸­
        const isTauriEnv = typeof window !== 'undefined' && window.__TAURI__;
        
        // æ—¥å¿—å‡½æ•°
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logElement = document.getElementById('test-log');
            const logEntry = `[${timestamp}] ${message}\n`;
            logElement.textContent += logEntry;
            logElement.scrollTop = logElement.scrollHeight;
            
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        function clearLog() {
            document.getElementById('test-log').textContent = 'æµ‹è¯•æ—¥å¿—å·²æ¸…ç©º...\n';
        }

        // æ˜¾ç¤ºç»“æœçš„é€šç”¨å‡½æ•°
        function showResult(elementId, data, isError = false) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result ${isError ? 'error' : 'success'}`;
            element.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
        }

        // æ›´æ–°è¿æ¥çŠ¶æ€
        function updateConnectionStatus(connected, message = '') {
            const statusElement = document.getElementById('connection-status');
            const indicator = statusElement.querySelector('.status-indicator');
            const text = statusElement.querySelector('span:last-child');
            
            if (connected) {
                indicator.className = 'status-indicator status-connected';
                text.textContent = 'âœ… åç«¯è¿æ¥æ­£å¸¸' + (message ? ` - ${message}` : '');
            } else {
                indicator.className = 'status-indicator status-disconnected';
                text.textContent = 'âŒ åç«¯è¿æ¥å¤±è´¥' + (message ? ` - ${message}` : '');
            }
        }

        // Tauri APIè°ƒç”¨åŒ…è£…å‡½æ•°
        async function invokeCommand(command, args = {}) {
            if (!isTauriEnv) {
                throw new Error('ä¸åœ¨Tauriç¯å¢ƒä¸­ï¼Œæ— æ³•è°ƒç”¨åç«¯å‘½ä»¤');
            }
            
            try {
                log(`è°ƒç”¨å‘½ä»¤: ${command}`, 'info');
                const result = await window.__TAURI__.invoke(command, args);
                log(`å‘½ä»¤ ${command} æ‰§è¡ŒæˆåŠŸ`, 'info');
                return result;
            } catch (error) {
                log(`å‘½ä»¤ ${command} æ‰§è¡Œå¤±è´¥: ${error.message}`, 'error');
                throw error;
            }
        }

        // ç³»ç»ŸçŠ¶æ€æµ‹è¯•
        async function testSystemStatus() {
            try {
                const status = await invokeCommand('get_system_status');
                showResult('system-result', status);
                updateConnectionStatus(true, `æ´»è·ƒä»»åŠ¡: ${status.active_test_tasks}`);
                log(`ç³»ç»ŸçŠ¶æ€: ${JSON.stringify(status)}`, 'success');
            } catch (error) {
                showResult('system-result', `é”™è¯¯: ${error.message}`, true);
                updateConnectionStatus(false, error.message);
                log(`è·å–ç³»ç»ŸçŠ¶æ€å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testSystemHealth() {
            try {
                const status = await invokeCommand('get_system_status');
                const isHealthy = status.system_health === 'healthy';
                showResult('system-result', `ç³»ç»Ÿå¥åº·çŠ¶æ€: ${isHealthy ? 'âœ… å¥åº·' : 'âŒ å¼‚å¸¸'}`);
                log(`ç³»ç»Ÿå¥åº·æ£€æŸ¥: ${isHealthy ? 'é€šè¿‡' : 'å¤±è´¥'}`, isHealthy ? 'success' : 'error');
            } catch (error) {
                showResult('system-result', `å¥åº·æ£€æŸ¥å¤±è´¥: ${error.message}`, true);
                log(`ç³»ç»Ÿå¥åº·æ£€æŸ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æ•°æ®ç®¡ç†æµ‹è¯•
        async function testGetAllDefinitions() {
            try {
                const definitions = await invokeCommand('get_all_channel_definitions');
                showResult('data-result', `è·å–åˆ° ${definitions.length} ä¸ªé€šé“å®šä¹‰:\n${JSON.stringify(definitions.slice(0, 3), null, 2)}${definitions.length > 3 ? '\n...(æ˜¾ç¤ºå‰3ä¸ª)' : ''}`);
                log(`æˆåŠŸè·å– ${definitions.length} ä¸ªé€šé“å®šä¹‰`, 'success');
            } catch (error) {
                showResult('data-result', `è·å–é€šé“å®šä¹‰å¤±è´¥: ${error.message}`, true);
                log(`è·å–é€šé“å®šä¹‰å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testGetAllBatches() {
            try {
                const batches = await invokeCommand('get_all_batch_info');
                showResult('data-result', `è·å–åˆ° ${batches.length} ä¸ªæµ‹è¯•æ‰¹æ¬¡:\n${JSON.stringify(batches, null, 2)}`);
                log(`æˆåŠŸè·å– ${batches.length} ä¸ªæµ‹è¯•æ‰¹æ¬¡`, 'success');
            } catch (error) {
                showResult('data-result', `è·å–æ‰¹æ¬¡ä¿¡æ¯å¤±è´¥: ${error.message}`, true);
                log(`è·å–æ‰¹æ¬¡ä¿¡æ¯å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testCreateTestInstance() {
            try {
                // ä½¿ç”¨æµ‹è¯•æ•°æ®
                const instance = await invokeCommand('create_test_instance', {
                    definitionId: 'test_def_001',
                    batchId: 'test_batch_001'
                });
                showResult('data-result', `åˆ›å»ºæµ‹è¯•å®ä¾‹æˆåŠŸ:\n${JSON.stringify(instance, null, 2)}`);
                log(`æˆåŠŸåˆ›å»ºæµ‹è¯•å®ä¾‹: ${instance.instance_id}`, 'success');
            } catch (error) {
                showResult('data-result', `åˆ›å»ºæµ‹è¯•å®ä¾‹å¤±è´¥: ${error.message}`, true);
                log(`åˆ›å»ºæµ‹è¯•å®ä¾‹å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // Excelå¯¼å…¥æµ‹è¯•
        async function testExcelImport() {
            try {
                const testFilePath = 'D:\\GIT\\Git\\code\\FactoryTesting\\æµ‹è¯•æ–‡ä»¶\\æµ‹è¯•IO.xlsx';
                const definitions = await invokeCommand('import_excel_file', { filePath: testFilePath });
                showResult('excel-result', `Excelå¯¼å…¥æˆåŠŸï¼Œè§£æåˆ° ${definitions.length} ä¸ªé€šé“å®šä¹‰:\n${JSON.stringify(definitions.slice(0, 2), null, 2)}${definitions.length > 2 ? '\n...(æ˜¾ç¤ºå‰2ä¸ª)' : ''}`);
                log(`Excelå¯¼å…¥æˆåŠŸï¼Œè§£æåˆ° ${definitions.length} ä¸ªé€šé“å®šä¹‰`, 'success');
            } catch (error) {
                showResult('excel-result', `Excelå¯¼å…¥å¤±è´¥: ${error.message}`, true);
                log(`Excelå¯¼å…¥å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testCreateBatch() {
            try {
                const batchInfo = {
                    batch_id: `test_batch_${Date.now()}`,
                    product_model: 'æµ‹è¯•äº§å“å‹å·',
                    serial_number: `SN${Date.now()}`,
                    customer_name: 'æµ‹è¯•å®¢æˆ·',
                    operator_name: 'æµ‹è¯•æ“ä½œå‘˜',
                    creation_time: new Date().toISOString(),
                    status: 'Created'
                };
                
                const definitions = [
                    {
                        id: `def_${Date.now()}_1`,
                        tag: 'AI001',
                        variable_description: 'æµ‹è¯•AIç‚¹1',
                        station_name: 'æµ‹è¯•ç«™',
                        module_name: 'æµ‹è¯•æ¨¡å—',
                        module_type: 'AI',
                        channel_number: 'CH01',
                        data_type: 'Float',
                        plc_communication_address: 'DB1.DBD0'
                    }
                ];
                
                const batchId = await invokeCommand('create_test_batch_with_definitions', {
                    batchInfo,
                    definitions
                });
                
                showResult('excel-result', `åˆ›å»ºæµ‹è¯•æ‰¹æ¬¡æˆåŠŸ:\næ‰¹æ¬¡ID: ${batchId}\näº§å“å‹å·: ${batchInfo.product_model}\nåºåˆ—å·: ${batchInfo.serial_number}`);
                log(`æˆåŠŸåˆ›å»ºæµ‹è¯•æ‰¹æ¬¡: ${batchId}`, 'success');
            } catch (error) {
                showResult('excel-result', `åˆ›å»ºæµ‹è¯•æ‰¹æ¬¡å¤±è´¥: ${error.message}`, true);
                log(`åˆ›å»ºæµ‹è¯•æ‰¹æ¬¡å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æµ‹è¯•æ‰§è¡Œæµ‹è¯•
        async function testStartBatch() {
            try {
                await invokeCommand('start_batch_testing', { batchId: 'test_batch_001' });
                showResult('execution-result', 'æ‰¹æ¬¡æµ‹è¯•å¯åŠ¨æˆåŠŸ');
                log('æ‰¹æ¬¡æµ‹è¯•å¯åŠ¨æˆåŠŸ', 'success');
            } catch (error) {
                showResult('execution-result', `å¯åŠ¨æ‰¹æ¬¡æµ‹è¯•å¤±è´¥: ${error.message}`, true);
                log(`å¯åŠ¨æ‰¹æ¬¡æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testGetProgress() {
            try {
                const progress = await invokeCommand('get_batch_progress', { batchId: 'test_batch_001' });
                showResult('execution-result', `æµ‹è¯•è¿›åº¦:\n${JSON.stringify(progress, null, 2)}`);
                log(`è·å–æµ‹è¯•è¿›åº¦æˆåŠŸï¼Œ${progress.length} ä¸ªæ›´æ–°`, 'success');
            } catch (error) {
                showResult('execution-result', `è·å–æµ‹è¯•è¿›åº¦å¤±è´¥: ${error.message}`, true);
                log(`è·å–æµ‹è¯•è¿›åº¦å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testStopBatch() {
            try {
                await invokeCommand('stop_batch_testing', { batchId: 'test_batch_001' });
                showResult('execution-result', 'æ‰¹æ¬¡æµ‹è¯•åœæ­¢æˆåŠŸ');
                log('æ‰¹æ¬¡æµ‹è¯•åœæ­¢æˆåŠŸ', 'success');
            } catch (error) {
                showResult('execution-result', `åœæ­¢æ‰¹æ¬¡æµ‹è¯•å¤±è´¥: ${error.message}`, true);
                log(`åœæ­¢æ‰¹æ¬¡æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æŠ¥å‘Šç”Ÿæˆæµ‹è¯•
        async function testGetTemplates() {
            try {
                const templates = await invokeCommand('get_report_templates');
                showResult('report-result', `è·å–åˆ° ${templates.length} ä¸ªæŠ¥å‘Šæ¨¡æ¿:\n${JSON.stringify(templates, null, 2)}`);
                log(`æˆåŠŸè·å– ${templates.length} ä¸ªæŠ¥å‘Šæ¨¡æ¿`, 'success');
            } catch (error) {
                showResult('report-result', `è·å–æŠ¥å‘Šæ¨¡æ¿å¤±è´¥: ${error.message}`, true);
                log(`è·å–æŠ¥å‘Šæ¨¡æ¿å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testGeneratePDF() {
            try {
                const request = {
                    batch_ids: ['test_batch_001'],
                    template_id: 'default_pdf',
                    output_filename: null,
                    parameters: {}
                };
                
                const report = await invokeCommand('generate_pdf_report', { request });
                showResult('report-result', `PDFæŠ¥å‘Šç”ŸæˆæˆåŠŸ:\næŠ¥å‘ŠID: ${report.report_id}\næ–‡ä»¶è·¯å¾„: ${report.file_path}\næ–‡ä»¶å¤§å°: ${report.file_size} å­—èŠ‚`);
                log(`PDFæŠ¥å‘Šç”ŸæˆæˆåŠŸ: ${report.report_id}`, 'success');
            } catch (error) {
                showResult('report-result', `ç”ŸæˆPDFæŠ¥å‘Šå¤±è´¥: ${error.message}`, true);
                log(`ç”ŸæˆPDFæŠ¥å‘Šå¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testGenerateExcel() {
            try {
                const request = {
                    batch_ids: ['test_batch_001'],
                    template_id: 'default_excel',
                    output_filename: null,
                    parameters: {}
                };
                
                const report = await invokeCommand('generate_excel_report', { request });
                showResult('report-result', `ExcelæŠ¥å‘Šç”ŸæˆæˆåŠŸ:\næŠ¥å‘ŠID: ${report.report_id}\næ–‡ä»¶è·¯å¾„: ${report.file_path}\næ–‡ä»¶å¤§å°: ${report.file_size} å­—èŠ‚`);
                log(`ExcelæŠ¥å‘Šç”ŸæˆæˆåŠŸ: ${report.report_id}`, 'success');
            } catch (error) {
                showResult('report-result', `ç”ŸæˆExcelæŠ¥å‘Šå¤±è´¥: ${error.message}`, true);
                log(`ç”ŸæˆExcelæŠ¥å‘Šå¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æ‰‹åŠ¨æµ‹è¯•
        async function testManualSubTest() {
            try {
                const args = {
                    instance_id: 'test_instance_001',
                    sub_test_item: 'HardPoint',
                    params: { percentage: 0.5, tolerance: 0.02 }
                };
                
                const outcome = await invokeCommand('execute_manual_sub_test_cmd', args);
                showResult('manual-result', `æ‰‹åŠ¨å­æµ‹è¯•æ‰§è¡ŒæˆåŠŸ:\n${JSON.stringify(outcome, null, 2)}`);
                log(`æ‰‹åŠ¨å­æµ‹è¯•æ‰§è¡ŒæˆåŠŸ: ${outcome.success ? 'é€šè¿‡' : 'å¤±è´¥'}`, outcome.success ? 'success' : 'error');
            } catch (error) {
                showResult('manual-result', `æ‰§è¡Œæ‰‹åŠ¨å­æµ‹è¯•å¤±è´¥: ${error.message}`, true);
                log(`æ‰§è¡Œæ‰‹åŠ¨å­æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testReadChannelValue() {
            try {
                const args = {
                    instance_id: 'test_instance_001',
                    plc_address: 'DB1.DBD0',
                    data_type: 'Float'
                };
                
                const value = await invokeCommand('read_channel_value_cmd', args);
                showResult('manual-result', `è¯»å–é€šé“å€¼æˆåŠŸ:\nåœ°å€: ${args.plc_address}\nå€¼: ${JSON.stringify(value)}`);
                log(`è¯»å–é€šé“å€¼æˆåŠŸ: ${args.plc_address} = ${JSON.stringify(value)}`, 'success');
            } catch (error) {
                showResult('manual-result', `è¯»å–é€šé“å€¼å¤±è´¥: ${error.message}`, true);
                log(`è¯»å–é€šé“å€¼å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testWriteChannelValue() {
            try {
                const args = {
                    instance_id: 'test_instance_001',
                    plc_address: 'DB1.DBD0',
                    data_type: 'Float',
                    value_to_write: 42.5
                };
                
                await invokeCommand('write_channel_value_cmd', args);
                showResult('manual-result', `å†™å…¥é€šé“å€¼æˆåŠŸ:\nåœ°å€: ${args.plc_address}\nå€¼: ${args.value_to_write}`);
                log(`å†™å…¥é€šé“å€¼æˆåŠŸ: ${args.plc_address} = ${args.value_to_write}`, 'success');
            } catch (error) {
                showResult('manual-result', `å†™å…¥é€šé“å€¼å¤±è´¥: ${error.message}`, true);
                log(`å†™å…¥é€šé“å€¼å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('é›†æˆæµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ', 'info');
            
            if (isTauriEnv) {
                log('âœ… æ£€æµ‹åˆ°Tauriç¯å¢ƒï¼Œå¯ä»¥è¿›è¡Œåç«¯é€šä¿¡æµ‹è¯•', 'success');
                updateConnectionStatus(true, 'ç¯å¢ƒæ£€æµ‹é€šè¿‡');
                
                // è‡ªåŠ¨æ‰§è¡Œç³»ç»ŸçŠ¶æ€æ£€æŸ¥
                setTimeout(testSystemStatus, 1000);
            } else {
                log('âŒ æœªæ£€æµ‹åˆ°Tauriç¯å¢ƒï¼Œè¯·åœ¨Tauriåº”ç”¨ä¸­æ‰“å¼€æ­¤é¡µé¢', 'error');
                updateConnectionStatus(false, 'éTauriç¯å¢ƒ');
                
                // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
                const buttons = document.querySelectorAll('.button');
                buttons.forEach(button => {
                    button.disabled = true;
                    button.textContent += ' (éœ€è¦Tauriç¯å¢ƒ)';
                });
            }
        });
    </script>
</body>
</html> 